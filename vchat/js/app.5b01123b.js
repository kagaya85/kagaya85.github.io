(function(e){function t(t){for(var s,r,i=t[0],u=t[1],c=t[2],l=0,d=[];l<i.length;l++)r=i[l],o[r]&&d.push(o[r][0]),o[r]=0;for(s in u)Object.prototype.hasOwnProperty.call(u,s)&&(e[s]=u[s]);f&&f(t);while(d.length)d.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],s=!0,r=1;r<n.length;r++){var i=n[r];0!==o[i]&&(s=!1)}s&&(a.splice(t--,1),e=u(u.s=n[0]))}return e}var s={},r={app:0},o={app:0},a=[];function i(e){return u.p+"js/"+({Register:"Register",about:"about",login:"login"}[e]||e)+"."+{Register:"895c21a3",about:"e2319132",login:"e17b2f3b"}[e]+".js"}function u(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.e=function(e){var t=[],n={Register:1,login:1};r[e]?t.push(r[e]):0!==r[e]&&n[e]&&t.push(r[e]=new Promise(function(t,n){for(var s="css/"+({Register:"Register",about:"about",login:"login"}[e]||e)+"."+{Register:"d0cf94dd",about:"31d6cfe0",login:"65710acf"}[e]+".css",o=u.p+s,a=document.getElementsByTagName("link"),i=0;i<a.length;i++){var c=a[i],l=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(l===s||l===o))return t()}var d=document.getElementsByTagName("style");for(i=0;i<d.length;i++){c=d[i],l=c.getAttribute("data-href");if(l===s||l===o)return t()}var f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.onload=t,f.onerror=function(t){var s=t&&t.target&&t.target.src||o,a=new Error("Loading CSS chunk "+e+" failed.\n("+s+")");a.code="CSS_CHUNK_LOAD_FAILED",a.request=s,delete r[e],f.parentNode.removeChild(f),n(a)},f.href=o;var m=document.getElementsByTagName("head")[0];m.appendChild(f)}).then(function(){r[e]=0}));var s=o[e];if(0!==s)if(s)t.push(s[2]);else{var a=new Promise(function(t,n){s=o[e]=[t,n]});t.push(s[2]=a);var c,l=document.createElement("script");l.charset="utf-8",l.timeout=120,u.nc&&l.setAttribute("nonce",u.nc),l.src=i(e),c=function(t){l.onerror=l.onload=null,clearTimeout(d);var n=o[e];if(0!==n){if(n){var s=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src,a=new Error("Loading chunk "+e+" failed.\n("+s+": "+r+")");a.type=s,a.request=r,n[1](a)}o[e]=void 0}};var d=setTimeout(function(){c({type:"timeout",target:l})},12e4);l.onerror=l.onload=c,document.head.appendChild(l)}return Promise.all(t)},u.m=e,u.c=s,u.d=function(e,t,n){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},u.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,t){if(1&t&&(e=u(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)u.d(n,s,function(t){return e[t]}.bind(null,s));return n},u.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="",u.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var d=0;d<c.length;d++)t(c[d]);var f=l;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var s=n("64a9"),r=n.n(s);r.a},"036e":function(e,t,n){},1:function(e,t){},"13ce":function(e,t,n){},2303:function(e,t,n){"use strict";var s=n("036e"),r=n.n(s);r.a},"4be9":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var s=n("2b0e"),r=n("bc3a"),o=n.n(r),a={baseURL:"http://115.159.56.102:3000",timeout:6e4,withCredentials:!0},i=o.a.create(a);i.interceptors.request.use(function(e){return e},function(e){return Promise.reject(e)}),i.interceptors.response.use(function(e){return e},function(e){return Promise.reject(e)}),Plugin.install=function(e){e.axios=i,window.axios=i,Object.defineProperties(e.prototype,{axios:{get:function(){return i}},$axios:{get:function(){return i}}})},s["default"].use(Plugin);Plugin;var u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("el-container",[n("el-header",{staticClass:"app-header"},[n("h1",{staticClass:"vchat"},[e._v("VChat")]),e.isLogin?n("b",[e._v(e._s(e.$t("welcome"))+", "+e._s(e.username)+"!")]):e._e()]),n("router-view"),n("el-footer",[n("el-row",{staticClass:"locale-switch"},[e._v("\n        "+e._s(e.$t("language"))+":\n        "),n("el-button",{attrs:{value:"en",type:"en"==e.$i18n.locale?"primary":"",round:""},on:{click:function(t){return e.changeLocale(t)}}},[e._v("En")]),n("el-button",{attrs:{value:"zh_cn",type:"zh_cn"==e.$i18n.locale?"primary":"",round:""},on:{click:function(t){return e.changeLocale(t)}}},[e._v("中")]),n("el-button",{attrs:{value:"ja",type:"ja"==e.$i18n.locale?"primary":"",round:""},on:{click:function(t){return e.changeLocale(t)}}},[e._v("日")])],1)],1)],1)],1)},c=[],l={name:"app",computed:{isLogin:function(){return this.$store.state.uid},username:function(){return this.$store.state.username}},methods:{changeLocale:function(e){this.$i18n.locale=e.currentTarget.value}}},d=l,f=(n("034f"),n("2877")),m=Object(f["a"])(d,u,c,!1,null,null,null),p=m.exports,g=n("8c4f"),h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("el-container",[n("el-menu",{staticClass:"user-list",attrs:{"default-active":"0"},on:{select:e.selected}},e._l(e.userList,function(t,s){return n("el-menu-item",{key:s,attrs:{index:s.toString()}},[e._v(e._s(0!=s?t.username:e.$t("chatRoom")))])}),1),n("el-container",[n("el-header",[n("h1",[e._v("\n          "+e._s(0!=e.selectIndex?e.userList[e.selectIndex].username:e.$t("chatRoom"))+"\n        ")])]),n("el-main",[n("el-scrollbar",{attrs:{native:!1,wrapStyle:"overflow-x: hidden;",noresize:!1,tag:"div"}},[n("div",{staticClass:"msg-win"},e._l(e.msgList[e.userList[e.selectIndex].username],function(t,s){return n("Message",{key:s,attrs:{isMe:t.username==e.$store.state.username,username:t.username}},[e._v(e._s(t.content))])}),1)]),n("SendBox",{staticClass:"send-box",on:{send:e.sendMsg}})],1)],1)],1)],1)},v=[],b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-input",{attrs:{type:"textarea",rows:5,placeholder:e.$t("messagePlaceholder"),maxlength:"500","show-word-limit":""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.sendClicked(t)}},model:{value:e.textarea,callback:function(t){e.textarea=t},expression:"textarea"}}),n("div",{staticClass:"input-bar"},[n("el-button",{attrs:{type:"primary"},on:{click:e.sendClicked}},[e._v(e._s(e.$t("send")))])],1)],1)},w=[],_={name:"sendBox",data:function(){return{textarea:""}},methods:{sendClicked:function(){0!=this.textarea.length&&(this.$emit("send",this.textarea),this.textarea="")}}},y=_,k=(n("b580"),Object(f["a"])(y,b,w,!1,null,"75c19008",null)),L=k.exports,$=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:["message",e.isMe?"is-me":"not-me"]},[e.isMe?e._e():n("div",{staticClass:"username"},[e._v(e._s(e.username))]),n("div",{staticClass:"bubble"},[e._t("default")],2)])},x=[],C={name:"message",props:{isMe:Boolean,username:String}},O=C,P=(n("c5d8"),Object(f["a"])(O,$,x,!1,null,"3ce0b940",null)),R=P.exports,j=n("8055"),I=n.n(j),S={server:"http//115.259.56.102:3000/"},E={name:"home",components:{SendBox:L,Message:R},data:function(){return{msgList:{chatRoom:[]},userList:[{username:"chatRoom",uid:"0"}],selectIndex:0,socket:null}},mounted:function(){var e=this;this.socket=I.a.connect(S.server),this.socket.on("connect",function(){e.$message({message:e.$t("connected"),type:"success"}),e.socket.emit("online",{username:e.$store.state.username,uid:e.$store.state.uid,token:e.$store.state.token})}),this.socket.on("user-list",function(t){e.userList=e.userList.concat(t)}),this.socket.on("connect_error",function(){console.log("Connection failed"),e.$message({message:e.$t("connect_error"),type:"error"})}),this.socket.on("reconnect_failed",function(){console.log("Reconnection failed")}),this.socket.on("online",function(t){e.$message(e.$t("hi")+", "+t.username+" "+e.$t("isOnline")+"!"),t.username!=e.$store.state.username&&e.userList.push({username:t.username,uid:t.uid})}),this.socket.on("offline",function(t){e.$message(e.$t("hi")+", "+t.username+" "+e.$t("isOffline")+"!");for(var n=0;n<e.userList.length;n++)if(e.userList[n].username==t.username&&e.userList[n].uid==t.uid){e.userList.splice(n,1),delete e.msgList[e.userList[n].username],e.selectIndex==n&&(e.selectIndex=0);break}}),this.socket.on("say",function(t){var n;console.log("Get message from "+t.from),n="chatRoom"==t.to?"chatRoom":t.from,e.msgList[t.from]||e.$set(e.msgList,n,[]),e.msgList[n].push({username:t.from,content:t.content}),e.$set(e.msgList,t.username,e.msgList[n])})},beforeDestroy:function(){this.socket.close()},methods:{sendMsg:function(e){var t=this.userList[this.selectIndex].username;console.log("Send message",this.$store.state.username,t),this.msgList[t]||this.$set(this.msgList,t,[]),this.msgList[t].push({username:this.$store.state.username,content:e}),this.$set(this.msgList,t,this.msgList[t]),this.socket.emit("say",{from:this.$store.state.username,to:t,content:e})},selected:function(e){this.selectIndex=e}}},M=E,A=(n("2303"),Object(f["a"])(M,h,v,!1,null,"1452839f",null)),T=A.exports,N=n("2f62");s["default"].use(N["a"]);var B=new N["a"].Store({state:{username:"",uid:"",token:""},mutations:{login:function(e,t){e.username=t.username,e.uid=t.uid,e.token=t.token},logout:function(e){e.username="",e.uid="",e.token=""}},actions:{}});s["default"].use(g["a"]);var F=new g["a"]({routes:[{path:"/",name:"home",meta:{requireAuth:!0},component:T},{path:"/about",name:"about",meta:{requireAuth:!0},component:function(){return n.e("about").then(n.bind(null,"f820"))}},{path:"/login",name:"login",component:function(){return n.e("login").then(n.bind(null,"a55b"))}},{path:"/register",name:"register",component:function(){return n.e("Register").then(n.bind(null,"73cf"))}}]});F.beforeEach(function(e,t,n){e.meta.requireAuth?B.state.token?n():n("/login"):n()});var q=F,U=n("a925"),z=n("cebc"),K=n("b2d6"),D=n.n(K),H=Object(z["a"])({language:"Language",hello:"Hello",login:"Login",register:"Register",plsInputUsername:"Please input username",plsInputPassword:"Please input password",plsRepeatPassword:"Please repeat password",passwordNotSame:"Passwords are different",confirm:"Confirm",plsInputCode:"Please input the code",InputCodeErr:"Identify code is wrong",changeCode:"Change code",registerOK:"Register success",registerFailed:"Register failed",send:"Send",messagePlaceholder:"Please input something...",chatRoom:"Chat Room",welcome:"Welcome",loginFailed:"Login failed, please check again",hi:"Hi",connected:"Connect to server",connect_error:"Connect error",isOnline:"is online now",isOffline:"is offline now"},D.a),J=H,G=n("f0d9"),V=n.n(G),W=Object(z["a"])({language:"语言",hello:"你好",login:"登录",register:"注册",plsInputUsername:"请输入用户名",plsInputPassword:"请输入密码",plsRepeatPassword:"请再次输入密码",passwordNotSame:"密码输入不相同",confirm:"确认",plsInputCode:"请输入验证码",InputCodeErr:"验证码错误",changeCode:"看不清，换一张",registerOK:"注册成功",registerFailed:"注册失败",send:"发送",messagePlaceholder:"说点什么吧...",chatRoom:"聊天室",welcome:"欢迎",loginFailed:"登陆错误，请检查账户密码",hi:"嘿",connected:"已连接到服务器",connect_error:"与服务器断开连接",isOnline:"上线了",isOffline:"下线了"},V.a),Q=W,X=n("c3ff"),Y=n.n(X),Z=Object(z["a"])({language:"言語",hello:"こんにちは",login:"ログイン",register:"登録",plsInputUsername:"ユーザー名を入力",plsInputPassword:"パスワードを入力",plsRepeatPassword:"パスワードを入力",passwordNotSame:"パスワードが違います",confirm:"確認",plsInputCode:"コードを入力",InputCodeErr:"コードエラー",changeCode:"コードを変える",registerOK:"登録成功します",registerFailed:"登録失敗した",send:"送る",messagePlaceholder:"何が言いたいですか...",chatRoom:"チャットルーム",welcome:"ようこそ",loginFailed:"ログインエラー",hi:"へ",connected:"Connect to server",connect_error:"Connect error",isOnline:"is online now",isOffline:"is offline now"},Y.a),ee=Z;s["default"].use(U["a"]);var te=new U["a"]({locale:"en",fallbackLocale:"en",messages:{en:J,zh_cn:Q,ja:ee}}),ne=n("5c96"),se=n.n(ne);n("0fae");s["default"].use(se.a,{i18n:function(e,t){return te.t(e,t)}}),s["default"].config.productionTip=!1,new s["default"]({router:q,store:B,i18n:te,render:function(e){return e(p)}}).$mount("#app")},"64a9":function(e,t,n){},b580:function(e,t,n){"use strict";var s=n("4be9"),r=n.n(s);r.a},c5d8:function(e,t,n){"use strict";var s=n("13ce"),r=n.n(s);r.a}});
//# sourceMappingURL=app.5b01123b.js.map